<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI Quiz — Interactive Web Page</title>
  <style>
    :root{--accent:#6C5CE7;--bg:#0f1724;--card:#0b1220;--muted:#9aa4b2}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial;background:linear-gradient(180deg,#071127 0%, #071726 60%);color:#e6eef6;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px}
    .container{width:100%;max-width:960px}

    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
    h1{font-size:20px;margin:0}
    .meta{color:var(--muted);font-size:13px}

    .grid{display:grid;grid-template-columns:1fr 340px;gap:18px}
    @media (max-width:880px){.grid{grid-template-columns:1fr}}

    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:18px;box-shadow:0 8px 24px rgba(2,6,23,0.6)}

    /* quiz area */
    .question-area{min-height:260px;display:flex;flex-direction:column;gap:14px}
    .question{font-size:18px}
    .choices{display:flex;flex-direction:column;gap:10px}
    .choice{background:rgba(255,255,255,0.03);padding:12px;border-radius:10px;cursor:pointer;border:1px solid transparent}
    .choice:hover{transform:translateY(-2px)}
    .choice.selected{border-color:var(--accent);box-shadow:0 6px 18px rgba(108,92,231,0.12)}
    .choice.correct{background:rgba(34,197,94,0.12);border-color:rgba(34,197,94,0.3)}
    .choice.wrong{background:rgba(239,68,68,0.08);border-color:rgba(239,68,68,0.25)}

    .controls{display:flex;gap:8px;align-items:center}
    button{background:var(--accent);color:white;border:0;padding:8px 12px;border-radius:10px;cursor:pointer;font-weight:600}
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06)}
    button:disabled{opacity:0.45;cursor:not-allowed}

    /* right column */
    .sidebar1 .panel{margin-bottom:12px}
    .progress{height:12px;background:rgba(255,255,255,0.04);border-radius:999px;overflow:hidden}
    .progress-bar{height:100%;width:0%;background:linear-gradient(90deg,var(--accent),#4f46e5);transition:width .35s}
    .info-row{display:flex;justify-content:space-between;font-size:13px;color:var(--muted);margin-top:8px}

    .score-big{font-size:36px;margin:12px 0}
    .small{font-size:13px;color:var(--muted)}

    footer{margin-top:14px;display:flex;justify-content:space-between;align-items:center;color:var(--muted);font-size:13px}

    /* admin form */
    .admin{margin-top:12px;border-top:1px dashed rgba(255,255,255,0.03);padding-top:12px}
    label{display:block;font-size:13px;margin-bottom:6px}
    input[type="text"],textarea,select{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    textarea{min-height:80px}

    .center{display:flex;align-items:center;justify-content:center}
    .hint{color:var(--muted);font-size:13px}




      /* Sidebar */
  .slider {
   width: 200px;
   height: 100vh;
   background-color: #2563EB;
   position: fixed;
   top: 0;
   left: 0;
   transform: translateX(-200px); /* hidden */
   transition: transform 0.4s ease-in-out;
   color: white;
   padding: 20px 10px;
   box-sizing: border-box;
   z-index: 998;
   margin-top: 10px;
   display: flex;
    flex-direction: column;
    margin: 1px;
  }

  /* ✅ Corrected navbar selector */
  .navbar.bg-body-tertiary {
    background-color: #2563EB;
    color: white;
    display: flex;
    align-items: center;
    justify-content: space-between;
      padding: 10px 20px;
}
    
  

  /* Toggle button (inside navbar left) */
  .slidbtn {
   position: relative;  /* ✅ stays inside navbar */
   display: inline-block;
   margin-right: 10px;
   z-index: 999;
  

  }
  .slidbtn button {
   width: 40px;
   height: 40px;
   background-color: rgb(15, 16, 17);
   color: white;
   border: none;
   cursor: pointer;
   font-size: 20px;
   border-radius: 5px;
   transition: background 0.2s;
  }
  .slidbtn button:hover {
   background-color: rgb(30, 30, 30);
  }

  /* Main content */
  .content {
   padding: 20px;
   transition: margin-left 0.4s ease-in-out;
  }

  /* ✅ Sidebar open state */
  body.open .slider {
    transform: translateX(0);
  }
  body.open .content {
    margin-left: 200px;
  }



/* Sidebar */
.sidebar {
  position: fixed;
  top: 0;
  left: 0;
  width: 240px;
  height: 100%;
  background: linear-gradient(180deg, #007bff, #0056b3);
  padding: 20px;
  color: white;
  font-family: Arial, sans-serif;
  box-shadow: 2px 0 10px rgba(0,0,0,0.2);
}
/* Buttons */
.menu button {
  display: block;
  width: 100%;
  padding: 12px;
  margin: 10px 0;
  border: none;
  border-radius: 8px;
  background: white;
  color: #007bff;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  text-align: center;
  transition: all 0.3s ease;
}

/* Hover effect */
.menu button:hover {
  background: #0056b3;
  color: white;
  transform: translateX(5px);
}
.logout-btn {
  background: #111;
  color: white;
  padding: 10px 15px;
  border-radius: 6px;
  text-decoration: none;
  font-size: 16px;
  transition: background 0.3s ease;
}

.logout-btn:hover {
  background: #e63946; /* red on hover */
}

.allcontenat {
  display: flex;
 flex-direction: column;
  min-height: 100vh;
  width: 100%;}

 
  
 
  


 
 

  </style>
</head>
<body>
<div class="allcontenat">

   <section>
    <nav class="navbar bg-body-tertiary">
      <div class="slidbtn">
        <button id="slider-btn" onclick="slidbar()">☰</button></div>
        <H1>📘 Smart Study  AI Quiz</H1>

  <a href="logout.html" class="logout-btn"><i class="fa-solid fa-right-from-bracket"></i> Logout</a>
<!-- </div> -->
<!-- </div> -->
    </nav>
  </section>
  
  <!-- Sidebar -->
  <div class="slider" id="slider">
<h2>Menu</h2>
<div class="menu">
  <button onclick="location.href='/home'">Home</button><br>
  <button onclick="location.href='/dashboard/dashboard'">Dashboard</button><br>
  <button onclick="location.href='/planner/planner'">Planner</button><br>
  <button onclick="location.href='/chatbot/chatbot'">AI Chatbot</button><br>
  <button onclick="location.href='/ai-quiz/'">AI Quizzes</button><br>
  <button onclick="location.href='#'">Notes Summariser</button><br>
  <button onclick="location.href='/reminders/reminders'">Reminder</button><br>
  <button onclick="location.href='/progress/progress'">Progress</button><br>
</div>
</div>



  <div class="container">
    <!-- <header>
      <div>
        <h1>AI Quiz — Test your basics</h1>
        <div class="meta">8 questions · multiple choice · built with vanilla JS</div>
      </div>
      <div class="meta">Tip: You can add questions in the "Add question" box</div>
    </header> -->

    <div class="grid">
      <main class="card">
        <div id="quiz" class="question-area">
          <!-- question injected here -->
        </div>

        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px">
          <div class="controls">
            <button id="prevBtn" class="ghost">◀ Previous</button>
            <button id="nextBtn">Next ▶</button>
            <button id="submitBtn" class="ghost">Submit</button>
          </div>
          <div class="small">Time left: <strong id="timer">--:--</strong></div>
        </div>

        <div id="result" style="display:none;margin-top:12px" class="card"></div>

        <footer>
          <div class="small">Answers are saved locally in your browser.</div>
          <div class="small">Good luck!</div>
        </footer>
      </main>

      <aside class="sidebar1">
        <div class="card panel">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <div class="small">Progress</div>
              <div class="progress" style="margin-top:8px"><div id="progressBar" class="progress-bar"></div></div>
            </div>
            <div style="text-align:right">
              <div class="small">Score</div>
              <div class="score-big" id="liveScore">0</div>
            </div>
          </div>
          <div class="info-row">
            <div>Question: <strong id="currentIndex">0</strong>/<span id="totalQ">0</span></div>
            <div id="correctCount">Correct: 0</div>
          </div>
        </div>

        <div class="card panel">
          <div class="small">High scores (local)</div>
          <div id="highScores" style="margin-top:10px" class="small hint">No scores yet</div>
        </div>

        <div class="card panel admin">
          <div style="font-weight:700;margin-bottom:8px">Add question</div>
          <label>Question</label>
          <input id="qText" type="text" placeholder="">

          <label>Options (comma separated)</label>
          <input id="qOpts" type="text" placeholder="">

          <label>Correct option (0-based index)</label>
          <input id="qAns" type="text" placeholder="0">

          <label>Explanation (optional)</label>
          <textarea id="qExp" placeholder=""></textarea>

          <div style="display:flex;gap:8px;margin-top:8px">
            <button id="addQ">Add question</button>
            <button id="resetQ" class="ghost">Reset default</button>
          </div>
        </div>
      </aside>
    </div>
  </div>
 </div>

<script>


 function slidbar() {
   document.body.classList.toggle("open");  

   const sliderBtn = document.getElementById("slider-btn");

   if (document.body.classList.contains("open")) {
     sliderBtn.style.display = "none"; // hide ☰ when sidebar opens
   } else {
     sliderBtn.style.display = "inline-block"; // show ☰ again when closed
   }
 }

 // ✅ Add click event to "Menu" heading for closing
 document.addEventListener("DOMContentLoaded", function() {
   const menuHeading = document.querySelector(".slider h2");
   menuHeading.addEventListener("click", function() {
     document.body.classList.remove("open"); // close sidebar
     document.getElementById("slider-btn").style.display = "inline-block"; // show ☰ again
   });
 });

 
  // --- Data (API se aayega) ---
  let questions = [];   // backend se fill hoga
  let index = 0;
  let answers = {};
  let correctCount = 0;
  let timerSeconds = 5 * 60;
  let timerInterval = null;

  // --- DOM refs ---
  const quizEl = document.getElementById('quiz');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');
  const submitBtn = document.getElementById('submitBtn');
  const progressBar = document.getElementById('progressBar');
  const currentIndexEl = document.getElementById('currentIndex');
  const totalQEl = document.getElementById('totalQ');
  const liveScoreEl = document.getElementById('liveScore');
  const correctCountEl = document.getElementById('correctCount');
  const timerEl = document.getElementById('timer');
  const resultEl = document.getElementById('result');
  const highScoresEl = document.getElementById('highScores');

  // admin inputs
  const qText = document.getElementById('qText');
  const qOpts = document.getElementById('qOpts');
  const qAns = document.getElementById('qAns');
  const qExp = document.getElementById('qExp');
  const addQ = document.getElementById('addQ');
  const resetQ = document.getElementById('resetQ');

  // --- Load Questions from API ---
  async function loadQuestions() {
    try {
      // 👇 Yaha apni API ka URL daalo
      const res = await fetch("https://your-backend-api.com/quiz?apikey=XXXX");
      const data = await res.json();
      questions = data.questions;
      totalQEl.textContent = questions.length;
      renderQuestion();
      startTimer();
    } catch (e) {
      console.error("Failed to load questions:", e);
      quizEl.innerHTML = "<div style='color:red'>Failed to load quiz questions. Check API.</div>";
    }
  }

  // --- Baaki sab same ---
  function renderQuestion() {
    if (!questions.length) return;
    const data = questions[index];
    currentIndexEl.textContent = index + 1;
    totalQEl.textContent = questions.length;
    quizEl.innerHTML = '';

    const qNode = document.createElement('div');
    qNode.className = 'question';
    qNode.textContent = data.q;
    quizEl.appendChild(qNode);

    const optsWrap = document.createElement('div');
    optsWrap.className = 'choices';

    data.opts.forEach((opt, i) => {
      const c = document.createElement('div');
      c.className = 'choice';
      c.textContent = opt;
      c.dataset.index = i;
      if (answers.hasOwnProperty(index) && answers[index] === i) c.classList.add('selected');

      c.addEventListener('click', () => {
        answers[index] = i;
        optsWrap.querySelectorAll('.choice').forEach(ch => ch.classList.remove('selected','correct','wrong'));
        c.classList.add('selected');
        updateLiveScore();
      });

      optsWrap.appendChild(c);
    });

    quizEl.appendChild(optsWrap);

    const expl = document.createElement('div');
    expl.style.marginTop = '8px';
    expl.className = 'small';
    expl.id = 'explain';
    quizEl.appendChild(expl);

    prevBtn.disabled = index === 0;
    nextBtn.disabled = index === questions.length - 1;

    const pct = Math.round((Object.keys(answers).length / questions.length) * 100);
    progressBar.style.width = pct + '%';
  }

  function updateLiveScore() {
    let score = 0; correctCount = 0;
    questions.forEach((q, i) => {
      if (answers.hasOwnProperty(i)) {
        if (answers[i] === q.a) { score += 10; correctCount++; }
      }
    });
    liveScoreEl.textContent = score;
    correctCountEl.textContent = 'Correct: ' + correctCount;
  }

  function showResult() {
    const data = questions[index];
    const choices = document.querySelectorAll('.choice');
    choices.forEach(ch => {
      ch.classList.remove('correct','wrong');
      const i = Number(ch.dataset.index);
      if (i === data.a) ch.classList.add('correct');
      if (answers[index] !== undefined && answers[index] !== data.a && i === answers[index]) ch.classList.add('wrong');
    });
    const expl = document.getElementById('explain');
    expl.textContent = data.exp || '';
  }

  function submitQuiz() {
    updateLiveScore();
    const finalScore = Number(liveScoreEl.textContent);
    const percent = Math.round((finalScore / (questions.length * 10)) * 100);
    resultEl.style.display = 'block';
    resultEl.innerHTML = `<div style="font-weight:700;font-size:18px">Result</div>
                          <div style="margin-top:8px">Final score: <strong>${finalScore}</strong> (${percent}%)</div>
                          <div style="margin-top:8px">Correct answers: <strong>${correctCount}</strong> / ${questions.length}</div>
                          <div style="margin-top:12px;display:flex;gap:8px"><button id=restart>Try again</button><button id=review class=ghost>Review answers</button></div>`;

    document.getElementById('restart').addEventListener('click', ()=>{
      answers = {}; updateLiveScore(); resultEl.style.display='none'; index=0; renderQuestion();
    });

    document.getElementById('review').addEventListener('click', ()=>{
      index = 0; renderQuestion(); showResult();
    });
    clearInterval(timerInterval);
  }

  function startTimer() {
    updateTimerDisplay();
    timerInterval = setInterval(()=>{
      timerSeconds--;
      if(timerSeconds <= 0){ clearInterval(timerInterval); timerSeconds = 0; updateTimerDisplay(); submitQuiz(); }
      else updateTimerDisplay();
    },1000);
  }

  function updateTimerDisplay() {
    const mm = String(Math.floor(timerSeconds/60)).padStart(2,'0');
    const ss = String(timerSeconds%60).padStart(2,'0');
    timerEl.textContent = mm+':'+ss;
  }

  // --- Events ---
  prevBtn.addEventListener('click', ()=>{ index = Math.max(0,index-1); renderQuestion(); });
  nextBtn.addEventListener('click', ()=>{ index = Math.min(questions.length-1,index+1); renderQuestion(); });
  submitBtn.addEventListener('click', ()=>{ if(confirm('Submit the quiz now?')) submitQuiz(); });

  document.addEventListener('click', (e)=>{
    if(e.target.classList.contains('choice')){
      setTimeout(()=>{ showResult(); },100);
    }
  });

  // Admin add question (still works with API data)
  addQ.addEventListener('click', ()=>{
    const text = qText.value.trim();
    const opts = qOpts.value.split(',').map(s=>s.trim()).filter(Boolean);
    const ans = Number(qAns.value);
    const exp = qExp.value.trim();
    if(!text || opts.length < 2 || isNaN(ans) || ans < 0 || ans >= opts.length){
      alert('Please fill question, options (min 2) and correct option index correctly.');
      return;
    }
    questions.push({q: text, opts: opts, a: ans, exp: exp});
    totalQEl.textContent = questions.length;
    qText.value=''; qOpts.value=''; qAns.value=''; qExp.value='';
    alert('Question added!');
  });

  // ❌ Reset default removed (no dummy data)
  resetQ.style.display = "none";

  // Init
  loadQuestions();
  // --- Load Questions (from backend) ---
async function loadQuestions() {
  try {
    const res = await fetch("http://localhost:5000/api/get-quiz");
    const data = await res.json();
    questions = data.questions || [];

    if (!questions.length) {
      quizEl.innerHTML = "<div>No quiz available. Please create one.</div>";
      return;
    }

    totalQEl.textContent = questions.length;
    renderQuestion();
    startTimer();
  } catch (e) {
    console.error("Failed to load quiz:", e);
    quizEl.innerHTML = "<div style='color:red'>Error loading quiz.</div>";
  }
}

</script>

</body>
</html>
